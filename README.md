# BlackJack_TypeScript_MVC
## 説明
MVCとOOPを意識してTSでBlackJackを作成しました
Modelに存在するクラスは変数をprivateに設定し、getterとsetterで管理するなど、堅牢性を重視しました。

## URL
https://hayato-kossy.github.io/BlackJack_TypeScript_MVC/

## 使用技術
使用技術　HTML/CSS/TypeScript/JavaScript

## 期間
期間　2022年10月中旬から下旬の2週間ほど、現在も思い付いたら追加機能を実装しています。

## 作成の経緯
主にMVCとOOPの学習とそのアウトプットのために開発しました。

Recursion(<https://recursionist.io/>)というコンピュータサイエンス学習プラットフォームにあるカリキュラムでMVCを学び、プロジェクト内で与えられたブラックジャックのmodelの基本的な仕様をもとに作成しました。

## こだわった点

①設計：MVCの概念を採用し、TypeScriptを用い、OOPを意識して開発しました。変数はprivateで宣言しgetterとsetterで変数の取得、更新を行なっています。Modelを設計する際には、特にゲームの進行を管理するTableクラスの設計を重視しており、実際のゲームの進行に関わる場面において、Playerの状態やCardやDeckの変数にアクセスしたい場合には、Tableクラスを経由しゲームに必要な状態や変数をTableクラスでもアクセスと保持できるように心がけました。　

②参考資料：開発を進める際には、後述する「はこだて未来大学」の「ディーラーをやっつけろ! 複雑系の数理とシミュレーション」のレポートを参照しながらブラックジャックの機能を作成、適宜追加しました。

③追加機能：追加機能としてカウンティング機能、またカウンティング機能とベーシックストラテジーをもとにしたPlayerのアクションのレコメンド機能、ダランベール法を使ったベッティングアルゴリズムとそのレコメンド機能を追加しました。それらの機能の追加の理由としては、ModelのPlayerクラスだけで完結する機能ではなく、MVCを活かした追加機能の方が面白いと考えたからです。そこで全てのプレイヤーのハンドをModelのTableで保持し、カウンティングやダランベール法を用いたベッティングアルゴリズムを実装し、それをPlayer（AI）のアクションにベーシックストラテジーをもとに反映させ、Viewで描画するメソッドを作り、Controllerで実行することにより、MVCを活かしつつBlackJackのルールも活かした追加機能を作成できました。　　

※追加機能の説明　　

カウンティング機能：Deck中にある「10」を引く確率を計算する手法です。カウンティングが高ければ１０を引く可能性が高く、低ければ１０を引く可能性は低いです。

ダランベール法を用いたベッティングアルゴリズム：連続で負けた回数によってベット金額を変える手法です。ダランベール法の計算に必要な情報を全て保持するのではなく、直近の勝敗とベッティング額、連勝回数をPlayerクラスに保持させ、再帰的な処理をすることにより計算量の短縮やメモリの節約に繋げました。

④拡張性：Modelにおいて、Tableクラスのターン遷移を司るメソッド以外はブラックジャック以外のゲームにも適用できるよう心がけて作りました。

## 苦労した点、作成時のエピソード

ブラックジャックの細かいルールは適宜調べながら実装していきました。その際に「はこだて未来大学」の「ディーラーをやっつけろ! 複雑系の数理とシミュレーション」（<https://www.fun.ac.jp/~sisp/old_report/2018/03/document03_A.pdf>）というレポートを参考にして開発しました。そこでルールを大方学び、その中でカウンティングという手法を知りました。カウンティングとは「デックをシャッフルしない状態で、カードを使い続けた場合のゲームに対して発生する利得を最大にすることを目的とした戦略」のことであり、簡単に言えば、山札にあるカードを予想し、手札に応じてアクションを変えるというものです。そのカウンティングを実装するために山札はカードがなくなるまで交換しないように開発しました。  
またレポートを読む中でベーシックストラテジーという、ディーラーと自分の手札の関係からアクションを決める戦術を知ったのでそれを実装しユーザーに対してはレコメンド機能として、AIに対してはアクションの判断材料にしました。

参考資料：https://www.fun.ac.jp/~sisp/old_report/2018/03/document03_A.pdf

## これからの改善点、拡張案
BlackJackのルールを重視するあまり、ターン遷移を扱うメソッドがBlackJackに特化してしまっている部分があるので特化せざるを得ないメソッドと、そうでないメソッドをわけ、継承やインターフェースを使って他のゲームも追加しやすい設計を考え直す必要があると考えました。

## Usage
賭け金を決めるとターンが始まり、そのターンのハンドで行えるアクションが表示されます

行えるアクションは、サレンダー、スタンド、ヒット、ダブル、です。

またブラックジャックの有名なイカサマであるカウンティングと、ブラックジャックのベーシックストラテジーを基にしたレコメンド機能、ベット金額のレコメンドがあります

## Demo
https://user-images.githubusercontent.com/91725975/200210634-0d3de0a0-9d9f-43f6-97b7-136157d9e2da.mov

## Note
推奨ブラウザはGoogle Chromeです。
